#tag WindowBegin Window Window1   BackColor       =   16777215   Backdrop        =   ""   BalloonHelp     =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   3.31e+2   ImplicitInstance=   True   LiveResize      =   True   MacProcID       =   0   MaxHeight       =   600   MaximizeButton  =   True   MaxWidth        =   800   MenuBar         =   1523402967   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   0   Resizeable      =   True   Title           =   "TokyoCabinet"   Visible         =   True   Width           =   3.66e+2   Begin ListBox lb1      AutoDeactivate  =   True      AutoHideScrollbars=   True      Bold            =   ""      Border          =   True      ColumnCount     =   2      ColumnsResizable=   ""      ColumnWidths    =   ""      DataField       =   ""      DataSource      =   ""      DefaultRowHeight=   -1      Enabled         =   True      EnableDrag      =   ""      EnableDragReorder=   ""      GridLinesHorizontal=   0      GridLinesVertical=   0      HasHeading      =   True      HeadingIndex    =   -1      Height          =   265      HelpTag         =   ""      Hierarchical    =   ""      Index           =   -2147483648      InitialParent   =   ""      InitialValue    =   "KEY	VALUE"      Italic          =   ""      Left            =   20      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   True      LockRight       =   True      LockTop         =   True      RequiresSelection=   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollBarVertical=   True      SelectionType   =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   14      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   326      _ScrollOffset   =   0      _ScrollWidth    =   -1   End   Begin PushButton pbTry      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "try"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   293      LockBottom      =   True      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   True      LockTop         =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   291      Underline       =   ""      Visible         =   True      Width           =   53   End   Begin PushButton pbReset      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "reset"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "Arial"      TextSize        =   0      TextUnit        =   0      Top             =   291      Underline       =   ""      Visible         =   True      Width           =   59   EndEnd#tag EndWindow#tag WindowCode#tag EndWindowCode#tag Events pbTry	#tag Event		Sub Action()		  Dim value As String		  Dim hdb As MemoryBlock=NewMemoryBlock(4)		  Dim ecode As Integer		  Dim s,t As String		  		  // create the object		  hdb = TC_tchdbnew		  // open the database		  if Not TC_tchdbopen(hdb, "/tmp/casket.hdb", HDBOWRITER + HDBOCREAT) Then		    ecode = TC_tchdbecode(hdb)		    MsgBox "open error: "+TC_tchdberrmsg(ecode)		    Return		  End If		  lb1.DeleteAllRows()		  lb1.AddRow "casket.hdb"		  lb1.Cell(0,1)="opened"		  		  t="foo"		  value = TC_tchdbget2(hdb, t)		  if value<>"" Then		    lb1.AddRow t		    s=DefineEncoding(value, Encodings.UTF8)		    lb1.Cell(lb1.LastIndex,1)="'"+s+"'"		  Else		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "get error ["+t+"]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  End If		  t="bar"		  value = TC_tchdbget2(hdb, t)		  if value<>"" Then		    lb1.AddRow t		    s=DefineEncoding(value, Encodings.UTF8)		    lb1.Cell(lb1.LastIndex,1)="'"+s+"'"		  Else		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "get error ["+t+"]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  End If		  t="baz"		  value = TC_tchdbget2(hdb, t)		  if value<>"" Then		    lb1.AddRow t		    s=DefineEncoding(value, Encodings.UTF8)		    lb1.Cell(lb1.LastIndex,1)="'"+s+"'"		  Else		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "get error ["+t+"]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  End If		  t="한"		  value = TC_tchdbget2(hdb, t)		  if value<>"" Then		    lb1.AddRow t		    s=DefineEncoding(value, Encodings.UTF8)		    lb1.Cell(lb1.LastIndex,1)="'"+s+"'"		  Else		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "get error ["+t+"]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		    		  End If		  		  // close the database		  if Not TC_tchdbclose(hdb) Then		    ecode = TC_tchdbecode(hdb)		    MsgBox "close error: "+TC_tchdberrmsg(ecode)		  End If		  		  '/* delete the object */		  TC_tchdbdel(hdb)		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbReset	#tag Event		Sub Action()		  Dim f As FolderItem		  f=GetFolderItem("/tmp/casket.hdb", f.PathTypeShell)		  f.Delete()		  lb1.DeleteAllRows()		  Dim value As MemoryBlock		  Dim hdb As MemoryBlock=NewMemoryBlock(4)		  Dim ecode As Integer		  Dim s,t As String		  		  // create the object		  hdb = TC_tchdbnew		  // open the database		  if Not TC_tchdbopen(hdb, "/tmp/casket.hdb", HDBOWRITER + HDBOCREAT) Then		    ecode = TC_tchdbecode(hdb)		    MsgBox "open error: "+TC_tchdberrmsg(ecode)		  End If		  lb1.DeleteAllRows()		  lb1.AddRow "casket.hdb"		  lb1.Cell(0,1)="created"		  		  // store records.		  lb1.AddRow "Storing records"		  if Not TC_tchdbput2(hdb, "foo", "hop") Then		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "put error [foo]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  Else		    lb1.AddRow "put successful:"		    lb1.Cell(lb1.LastIndex,1)="foo::hop"		  End		  		  if Not TC_tchdbput2(hdb, "bar", "step") Then		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "put error [bar]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  Else		    lb1.AddRow "put successful:"		    lb1.Cell(lb1.LastIndex,1)="bar::step"		  End		  		  if Not TC_tchdbput2(hdb, "한", "글") Then		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "put error [한]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  Else		    lb1.AddRow "put successful:"		    lb1.Cell(lb1.LastIndex,1)="한::글"		  End		  		  if Not TC_tchdbput2(hdb, "baz", "jump") Then		    ecode = TC_tchdbecode(hdb)		    lb1.AddRow "put error [baz]:"		    lb1.Cell(lb1.LastIndex,1)=TC_tchdberrmsg(ecode)		  Else		    lb1.AddRow "put successful:"		    lb1.Cell(lb1.LastIndex,1)="baz::jump"		  End		  		  lb1.AddRow "put"		  lb1.Cell(lb1.LastIndex,1)="successful"		  		  // close the database		  if Not TC_tchdbclose(hdb) Then		    ecode = TC_tchdbecode(hdb)		    MsgBox "close error: "+TC_tchdberrmsg(ecode)		  End If		  		  '/* delete the object */		  TC_tchdbdel(hdb)		  		End Sub	#tag EndEvent#tag EndEvents